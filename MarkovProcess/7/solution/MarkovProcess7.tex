%!Mode:: "TeX:UTF-8"
%!tex encoding = utf-8 unicode
%!tex ts-program = xelatex
\documentclass{ctexart}
\newif\ifpreface
%\prefacetrue
\input{../../../global/all}
\begin{document}
\large
\setlength{\baselineskip}{1.2em}
\ifpreface
  \input{../../../global/preface}
\else
  %\maketitle
\fi
\newgeometry{left=2cm,right=2cm,top=2cm,bottom=2cm}
%from_here_to_type
\allowdisplaybreaks[4]
\begin{problem}\label{pro:1}
  Let \((X_n:n \geq 0)\perp (Y_n: n \geq 0)\) are Markov chain on \(E\) with
  Transition matrix \((p_{ij}:i,j \in E),(q_{ij}:i,j \in E)\) respectively.
  Prove: \(\{(X_n,Y_n):n \geq 0\}\) are Markov chain on \(E \times E\).
  And calculate the transition matrix of \((X_n,Y_n):n \geq 0\).
\end{problem}
\begin{solution}
  \[
    \begin{aligned}
       & \mathbb{P}(X_0=i_0,\cdots,X_{n+1} =i_{n+1},Y_0=j_0,\cdots,Y_{n+1}=j_{n+1})
      \\= & \mathbb{P}(X_0=i_0,\cdots,X_{n+1} =i_{n+1})\mathbb{P}(Y_0=j_0,\cdots,Y_{n+1}=j_{n+1})
      \\= & \mathbb{P}(X_0=i_0)\prod_{k=0}^{n} p_{i_k i_{k+1} } \mathbb{P}(Y_0=j_0) \prod_{k=0}^{n} q_{j_k j_{k+1}}
      \\= & \mathbb{P}((X_0,Y_0)=(i_0,j_0)) \prod_{k=0}^{n} p_{i_k i_{k+1} } q_{j_k j_{k+1}}
      \\= & \mathbb{P}((X_0,Y_0)=(i_0,j_0)) \prod_{k=0}^{n} \mathbb{P}(X_k = i_k,X_{k + 1}=i_{k + 1})\mathbb{P}(Y_k=j_k,Y_{k + 1}=j_{k + 1})
      \\=& \mathbb{P}((X_0,Y_0)=(i_0,j_0)) \prod_{k=0}^{n} \mathbb{P}((X_k,Y_{k})=(i_k,j_{k}),(X_{k + 1},Y_{k + 1})=(i_{k + 1},j_{k + 1}))
    \end{aligned}
  \]
  So we get that \(\left((X_n,Y_n): n \in \mathbb{N}\right)\) is Markov chain with transition matrix
  \(r_{(i,j),(m,n)}=p_{im}q_{jn}\).
\end{solution}

\begin{problem}\label{pro:2}
  Let \(S_n\) be \(1\)-dimensional simple random walk, \(a \in \mathbb{Z}\).
  Let \(\tau := \inf \{n \geq 0: S_n =a\}\).
  Prove:
  \begin{enumerate}
    \item \((S_{\tau + n}:n \geq 0)\) is a one dimensional simple random walk.
    \item \((S_{n \wedge \tau }:n \geq 0)\) is a Markov chain on \(\mathbb{Z}\) and give its
      Transition matrix.
    \item \((S_{n \wedge \tau}:n \geq 0) \perp (S_{\tau + n}: n \geq 0)\).
  \end{enumerate}
\end{problem}
\begin{solution}
  \begin{enumerate}
    \item
      \[
        \begin{aligned}
           & \mathbb{P}(S_\tau=i_0,S_{\tau+1}=i_1,\cdots,S_{\tau+n}=i_n \mid \tau<\infty)
          \\= & \sum_{k \in \mathbb{N}}\mathbb{P}(\tau=k,S_\tau=i_0,S_{\tau+1}=i_1,\cdots,S_{\tau+n}=i_n \mid \tau<\infty)
          \\= & \sum_{k \in \mathbb{N}}\mathbb{P}(\tau=k,S_k=i_0,S_{k+1}=i_1,\cdots,S_{k+n}=i_n \mid \tau<\infty)
          \\= & \mathbbm{1}(a=i_0) \sum_{k \in \mathbb{N}}\mathbb{P}(S_0 \neq a,\cdots,S_{k-1}\neq a,S_k=a,S_{k+1}=i_1,\cdots,S_{k+n}=i_n \mid \tau<\infty)
          \\= & \frac{\mathbbm{1}(a=i_0) \sum_{k \in \mathbb{N}}\mathbb{P}(S_0 \neq a,\cdots,S_{k-1}\neq a,S_k=a,S_{k+1}=i_1,\cdots,S_{k+n}=i_n )}{\mathbb{P}(\tau<\infty)}
          \\= & \frac{\mathbbm{1}(a=i_0)}{\mathbb{P}(\tau<\infty)} \sum_{k \in \mathbb{N}}\mathbb{P}(S_0 \neq a,\cdots,S_{k-1}\neq a,S_k=a,S_{k+1}=i_1,\cdots,S_{k+n}=i_n)
          \\= & \frac{\mathbbm{1}(a=i_0)}{\mathbb{P}(\tau<\infty)} \sum_{k \in \mathbb{N}}\mathbb{P}(S_{k+1}=i_1,\cdots,S_{k+n}=i_n \mid S_0 \neq a,\cdots,S_{k-1}\neq a,S_k=a)
          \\ \times & \mathbb{P}(S_0 \neq a,\cdots,S_{k-1}\neq a,S_k=a)
          \\= & \frac{\mathbbm{1}(a=i_0)}{\mathbb{P}(\tau<\infty)} \sum_{k \in \mathbb{N}}\mathbb{P}(S_{k+1}=i_1,\cdots,S_{k+n}=i_n \mid S_k=a) \mathbb{P}(\tau=k)
          \\= & \frac{\mathbbm{1}(a=i_0)}{\mathbb{P}(\tau<\infty)} \sum_{k \in \mathbb{N}}\prod_{l=0}^{n-1} p_{i_l i_{l+1}} \mathbb{P}(\tau=k)=\mathbbm{1}(a=i_0) \prod_{l=0}^{n-1} p_{i_l i_{l+1}}
        \end{aligned}
      \]
      Where \(p_{ij}:i,j \in \mathbb{Z}\) is the transition matrix of \(S_n:n \in \mathbb{N}\).
      So \((S_{\tau+n}:n \in \mathbb{N})\) is Markov chain with transition matrix same as \(S_n\).
    \item       \[
        \begin{aligned}
           & \mathbb{P}(S_{\tau \wedge 0}=i_0,S_{\tau\wedge 1}=i_1,\cdots,S_{\tau\wedge n}=i_n \mid \tau<\infty)
          \\= & \sum_{k \in \mathbb{N}}\mathbb{P}(\tau=k,S_{\tau \wedge 0}=i_0,S_{\tau\wedge 1}=i_1,\cdots,S_{\tau\wedge n}=i_n \mid \tau<\infty)
          \\= & \sum_{k \in \mathbb{N}}\mathbb{P}(\tau=k,S_{k \wedge 0}=i_0,S_{k\wedge 1}=i_1,\cdots,S_{k\wedge n}=i_n \mid \tau<\infty)
          \\= & \sum_{k \geq n} \mathbb{P}(\tau =k,S_0=i_0,\cdots,S_n=i_n \mid \tau<\infty)
          \\+ & \sum_{k < n} \mathbb{P}(\tau =k,S_0=i_0,\cdots,S_{k-1}=i_{k-1},S_k=i_k=i_{k+1} =\cdots=i_n \mid \tau<\infty)
          \\= & \mathbbm{1}(i_0,i_1,\cdots,i_n \neq a) \prod_{k=0}^{n-1} p_{i_k i_{k+1}} + \sum_{k=0}^{n-1} \mathbbm{1}(i_0,\cdots,i_{k-1} \neq a,i_k=i_{k+1}=\cdots=i_n=a) \prod_{l=0}^{k-1} p_{i_l i_{l+1}}
          \\=&\prod_{k=0}^{n-1} (\mathbbm{1}(i_k=i_{k+1}=a)+\mathbbm{1}(i_k \neq a)p_{i_k,i_{k+1}})
        \end{aligned}
      \]
      So \((S_{n \wedge \tau}:n \in \mathbb{N})\) is Markov chain with transition matrix \(q_{i,j}=\mathbbm{1}(i=j=a)+\mathbbm{1}(i \neq a)p_{i,j}\).
    \item By the corollary 3.2.11, we only need to proof \(\tau\) is stopping time on \((\mathscr{\mathcal{F}}_n:n \geq 0)\),
      Where \(\mathscr{\mathcal{F}}_n=\sigma(S_k:k \leq n)\).
      So we only need to prove \(\forall n \in \mathbb{N}\), \(\{\tau = n\} \in \mathscr{\mathcal{F}}_n\).
      Since \(\{\tau =n\}=\{\omega \in \omega: S_0,\cdots,S_{n + 1} \neq a, S_n = a\}=\bigcap_{0 \leq k \leq n}\{S_k \neq a\}\cap\{S_n=a\}\),
      And \(\{S_k \neq a\} \in \sigma(S_k), \forall 0 \leq k \leq n,\{S_n = a\} \in \sigma(S_n)\),
      Then \(\{\tau = n\} \in \mathscr{\mathcal{F}}_n\).
  \end{enumerate}
\end{solution}

\begin{problem}\label{pro:3}
  Let \(S_n\) be \(1\)-dimensional symmetry simple random walk starting from zero.
  Prove: \((|S_n|: n \geq 0)\) is a Markov chain on \(\mathbb{Z}^+\) and give its transition matrix.
\end{problem}
\begin{solution}
  Only need to solve problem \ref{pro:4}.
\end{solution}

\begin{problem}\label{pro:4}
  Let \(S_n\) be \(1\)-dimensional simple random walk starting from zero.
  Prove: \((|S_n|: n \geq 0)\) is a Markov chain on \(\mathbb{Z}^+\) and give its transition matrix.
\end{problem}
\begin{solution}
  By the definition of \(|S_n|\), we can easily get to know
  \(\forall (i_0,\cdots,i_n) \in \mathbb{Z}^{+}\), \(\mathbb{P}(|S_k|=i_k,k=0,\cdots,n)>0 \iff i_0=0,|i_k-i_{k-1}|=1, k=1,\cdots,n\).
  Let \(S_n=\sum_{k=1}^n \xi_k\), where \((\xi_n:n \geq)\) are i.i.d. r.v. and \(\mathbb{P}(\xi_1=1)=p,\mathbb{P}(\xi_1=-1)=q\).
  \(A:=\{(i_0,\cdots,i_{n + 1}) \in \mathbb{Z}: i_0=0,|i_k-i_{k- 1}|=1,k=1,\cdots,n + 1\}\).
  \(\forall (i_0,\cdots,i_{n + 1}) \in A\), let \(r :=\max \{k<n+1:i_k=0\}\).
  Then \(i_r=0,\forall k:n+1>k \geq r + 1, i_k \geq 1\).
  \begin{enumerate}
    \item \(\forall (i_0,\cdots,i_{n + 1}) \notin A\), then \(\mathbb{P}(|S_k|=i_k,k=0,\cdots,n) =0\),
      Then we have no need to calculate \(\mathbb{P}\Bigl(|S_{n + 1}|=i_{n + 1} \Bigl|  |S_k|=i_k,k=0,\cdots,n\Bigr)\).
    \item If \((i_0,\cdots,i_{n+1}) \in A \AND r=n\), then \(i_n=0,i_{n+1}=1\).
      Then \(|S_n|=0 \iff S_n=0 \implies S_{n+1}=\pm 1 \iff |S_{n+1}|=1\).
      So we get that
      \(\mathbb{P}\Bigl(|S_{n+1}| =i_{n+1}\Bigl| |S_{k}|=i_{k},k=1,\cdots,n\Bigr)=1=\mathbb{P}\Bigl(|S_{n+1}| =i_{n+1}\Bigl| |S_{n}|=i_{n}\Bigr)\).
    \item \(\forall(i_0,\cdots,i_{n + 1}) \in A,i_n \neq 0\),
      \[
        \begin{aligned}
           & \mathbb{P}\Bigl(|S_{k}|=i_k,S_n=i_n,k=0,\cdots,n\Bigl|  |S_k|=i_k,k=0,\cdots,r\Bigr)
          \\                         & =\mathbb{P}\Bigl(|S_{k}|=i_k,S_n=i_n,k=r + 1,\cdots,n\Bigl|  |S_k|=i_k,k=0,\cdots,r-1,S_r=0\Bigr)
          \\                         & =\mathbb{P}\Bigl(|S_{k}|=i_k,S_n=i_n,k=r +1,\cdots,n\Bigl|  S_r=0\Bigr)
          \\                         & =\mathbb{P}\Bigl(S_{k}=i_k,S_n=i_n,k=r +1,\cdots,n\Bigl|  S_r=0\Bigr)
          \\&=p^{\frac{n-r + i_n}{2}}q^{\frac{n-r -i_n}{2}}
        \end{aligned}
      \]
      In the same way, we can get
      \[
        \mathbb{P}\Bigl(|S_{k}|=i_k,S_n=-i,k=0,\cdots,n\Bigl|  |S_k|=i_k,k=0,\cdots,r\Bigr)=p^{\frac{n-r - i_n}{2}}q^{\frac{n-r +i}{2}}
      \]
      So
      \[
        \begin{aligned}
           & \mathbb{P}\Bigl(S_{n}=i_n\Bigl|  |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\                                      & =          \frac{\mathbb{P}(S_{n}=i_n,|S_k|=i_k,k=0,\cdots,n)}{\mathbb{P}(|S_k|=i_k,k=0,\cdots,n)}
          \\                                      & =          \frac{\mathbb{P}\Bigl(S_{n}=i_n,|S_k|=i_k,k=0,\cdots,n\Bigl| |S_k|=i_k,k=0,\cdots,r\Bigr)\mathbb{P}(|S_k|=i_k,k=0,\cdots,r)}{\mathbb{P}(|S_k|=i_k,k=0,\cdots,n)}
          \\                                      & =          \frac{\mathbb{P}\Bigl(S_{n}=i_n,|S_k|=i_k,k=0,\cdots,n\Bigl| |S_k|=i_k,k=0,\cdots,r\Bigr)}{\frac{\mathbb{P}(|S_k|=i_k,k=0,\cdots,n)}{\mathbb{P}(|S_k|=i_k,k=0,\cdots,r)}}
          \\                                      & =          \frac{\mathbb{P}\Bigl(S_{n}=i_n,|S_k|=i_k,k=0,\cdots,n\Bigl||S_k|=i_k,k=0,\cdots,r\Bigr)}{\mathbb{P}\Bigl(|S_k|=i_k,k=0,\cdots,n\Bigl| |S_k|=i_k,k=0,\cdots,r\Bigr)}
          \\                                      & =          \frac{\mathbb{P}\Bigl(S_{n}=i_n,|S_k|=i_k,k=0,\cdots,n\Bigl||S_k|=i_k,k=0,\cdots,r\Bigr)}{\mathbb{P}\Bigl(|S_k|=i_k,k=r + 1,\cdots,n\Bigl| |S_k|=i_k,k=0,\cdots,r\Bigr)}
          \\                                      & =\frac{p^{n - r + \frac{i_n}{2}}q^{n-r - \frac{i_n}{2}}}{p^{n - r + \frac{i_n}{2}}q^{n-r - \frac{i_n}{2}}+p^{n - r - \frac{i_n}{2}}q^{n-r + \frac{i_n}{2}}}
          \\&=p^{i_n}(p^{i_n}+q^{i_n})^{-1}
        \end{aligned}
      \]
      In the same way, we can get
      \[
        \mathbb{P}\Bigl(S_{n}=-i_n\Bigl|  |S_k|=i_k,k=0,\cdots,n\Bigr)=q^{i_n}(p^{i_n}+q^{i_n})^{-1}
      \]
      Then
      \[
        \begin{aligned}
           & \mathbb{P}\Bigl(|S_{n + 1}|=i_{n + 1}\Bigl|  |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\                           & =          \mathbb{P}\Bigl(|S_{n + 1}|=i_{n + 1}\mid S_n=i_n ,|S_k|=i_k,k=0,\cdots,n)\mathbb{P}(S_n=i_n \Bigl| |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\                         & +\mathbb{P}\Bigl(|S_{n + 1}|=i_{n + 1}\mid S_n=-i_n ,|S_k|=i_k,k=0,\cdots,n)\mathbb{P}(S_n=-i_n \Bigl| |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\                         & =\mathbb{P}\Bigl(S_{n + 1}=i_{n + 1}\Bigl|S_n=i_n\Bigr) \mathbb{P}\Bigl(S_n=i_n \Bigl| |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\                         & +\mathbb{P}\Bigl(S_{n + 1}=-i_{n + 1}\Bigl|S_n=-i_n\Bigr) \mathbb{P}\Bigl(S_n=-i_n \Bigl| |S_k|=i_k,k=0,\cdots,n\Bigr)
          \\ &=\mathbbm{1}(i_{n + 1}=i_n +1)(p^{i_n + 1} +q^{i_n + 1})(p^{i_n} + q^{i_n})^{-1} + \mathbbm{1}(i_{n + 1}=i_n-1)(p^{i_n}q +pq^{i_n })(p^{i_n} + q^{i_n})^{-1}
        \end{aligned}
      \]
  \end{enumerate}
  Thus, \((|S_n|:n \geq 0)\) is Markov chain on \(\mathbb{Z}^+\), with transition matrix
  \(r_{ij}=\mathbbm{1}(0 \neq i = j-1)(p^{i + 1} +q^{i + 1})(p^{i} + q^{i})^{-1} + \mathbbm{1}(0 \neq i =j+1)(p^{i}q +pq^{i })(p^{i} + q^{i})^{-1} +\mathbbm{1}(i=0,j=1)\).
  When \(p=q=\frac{1}{2}\), we get \(r_{ij}=\frac{1}{2}\mathbbm{1}(i \neq 0,|j-i|=1) + \mathbbm{1}(i=0,j=1)\).

\end{solution}
\end{document}
