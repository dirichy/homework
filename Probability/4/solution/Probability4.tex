%!Mode:: "TeX:UTF-8"
%!TEX TS-program = xelatex
%arara: xelatex

\documentclass{ctexart}
% \newcommand{\floor}{\lfloor #1 \rfloor}
\newif\ifpreface
\prefacefalse
\input{../../../global/all}
\begin{document}
\large
\setlength{\baselineskip}{1.2em}
\ifpreface
\input{../../../global/preface}
\newgeometry{left=2cm,right=2cm,top=2cm,bottom=2cm}
\else
\newgeometry{left=2cm,right=2cm,top=2cm,bottom=2cm}
\maketitle
\fi
%from_here_to_type
%p72 1,2,7,10
\begin{problem} \label{pro:3.6.1}
  设\(f \)的积分存在。证明：
  \(\int_{\Omega} f \d \mu = \lim_{n \to \infty} \sum_{i = - \infty}^{\infty} \frac{i}{2^n} \mu \left(\{\frac{i}{2^n} \leq f < \frac{i + 1}{2^n}\}\right) \)。
\end{problem}

\begin{solution}
  对一般的测度\(\mu \)不成立，反例如下：

  取\(\Omega=[1,\infty),\mu \)为勒贝格测度，\(f(x):=-\frac{1}{x^2} \)，则易知\(f(x) \)是可积的，故积分存在。
  但对任何\(n \)，有\(\mu(\{\frac{-1}{2^n} \leq f < \frac{0}{2^n}\})=\infty \)，于是\( \sum_{i = - \infty}^{\infty} \frac{i}{2^n} \mu \left(\{\frac{i}{2^n} \leq f < \frac{i + 1}{2^n}\}\right)=-\infty \)，
  故题设不成立。

  对有限测度\(\mu \)是成立的，下面给出证明：

  记\(A_{n,i}:= \{x:\frac{i}{2^n} \leq f(x) < \frac{i + 1}{2^n}\}\)。
  令\(g_n(x):=\frac{\floor{f(x)2^n}}{2^n}\)，则有\(g_n(x)=\frac{i}{2^n} \iff i \leq f(x)2^n < i + 1 \iff x \in A_{n,i} \)，故\(g_n(x)=\sum_{i=-\infty}^{\infty}\mathbbm{1}_{A_{n,i}}(x) \frac{i}{2^n} \)。
  由\(A_{n,i} \)的定义可知\(g_n(x) \leq f(x) < g_n(x) + \frac{1}{2^n} \)，故\(|g_n| \leq |f|+ \frac{1}{2^n} \)。
  由\(f \)可积，\(\mu \)有限，知\(|f| + \frac{1}{2^n} \)可积，
  于是由控制收敛定理知\(\int_{\Omega} f \d \mu=\lim_{n} \int_{\Omega} g_n \d \mu = \lim_{n \to \infty} \sum_{i = - \infty}^{\infty} \frac{i}{2^n} \mu \left(\{\frac{i}{2^n} \leq f < \frac{i + 1}{2^n}\}\right)  \)。
\end{solution}

\begin{problem}\label{pro:3.6.2}
  设\(f \)为非负可测函数，令：
  \(\overline{\int}_{\Omega} f \d \mu := \inf\left\{\int_{\Omega} g \d \mu:g \geq f,g \text{为简单函数}\right\} \)。
  举例说明\(\overline{\int} \)与\(\int \)未必相同，并解释为何不将积分定义为\(\overline{\int} \)。
\end{problem}
\begin{solution}
  令\(\Omega=[1,\infty),\mu \)为勒贝格测度，令\(f(x)=\frac{1}{x^2} \)，则易知\(\int_{\Omega} f \d \mu < \infty \)。
  考查\(g \geq f \)为简单函数，令\(\varepsilon=\inf_{x \in \Omega}g(x) \)，由于\(g(x) \)值域有限，故\(\exists x \in \Omega,g(x)=\varepsilon \geq f(x)>0 \)。
  于是\(\int_{\Omega} g \d \mu \geq \int_{\Omega} \varepsilon \d \mu = \varepsilon \mu\{\Omega\}=\infty \)。故\(\overline{\int}_{\Omega} f \d \mu = \infty \neq \int_{\Omega} f \d \mu \)。

  使用\(\int \)而不是\(\overline{\int} \)的原因应该是为了保证所有广义黎曼可积的非负函数都可积。
\end{solution}

\begin{problem}\label{pro:3.6.7}
  设\(\{f_{nm}\}_{n,m \geq 1} \)为一族非负实数。证明\(\liminf_{m \to \infty} \sum_{n = 1}^{\infty}f_{nm} \geq \sum_{n = 1}^{\infty}\liminf_{m \to \infty}f_{nm} \)。
\end{problem}

\begin{solution}
  令\(\Omega=\mathbb{N}_{+},\mu \)为计数测度。记\(g_m(n):=f_{nm} \)。则\(\int_{\Omega} g_m \d \mu =\sum_{n=1}^{\infty} \mu\{n\} g_m(n)=\sum_{n=1}^{\infty}f_{nm} \)。
  由 Fatou 定理知\(\liminf_{m \to \infty} \sum_{n = 1}^{\infty}f_{nm} =\liminf_{m \to \infty} \int_{\Omega} g_m \d \mu \geq \int_{\Omega} \liminf_{m \to \infty} g_m \d \mu =\sum_{n = 1}^{\infty}\liminf_{m \to \infty}f_{nm} \)。
\end{solution}

\begin{problem}\label{pro:3.6.10}
  若\(\xi_n \)依分布收敛于\(\xi \)，则\(\mathbb{E} |\xi| \leq \liminf_{n \to \infty}\mathbb{E} |\xi_n| \)。
\end{problem}

\begin{lemma}\label{lem:1}
  若\(\xi_n \overset{d}{\to} \xi\)，则对任何有界连续函数\(g:\mathbb{R} \to \mathbb{R} \)，有\(\mathbb{E} g(\xi_n) \to \mathbb{E} g(\xi) \)。
\end{lemma}
\begin{proof}
  不妨设\(g \)非负，否则用\(g-\min g \)代替\(g \)。

  首先证明\(\forall x \in \mathbb{R},\liminf_{n}\mathbb{P}(\xi_n<x) \geq \mathbb{P}(\xi<x),\limsup_{n}\mathbb{P}(\xi_n \leq x) \leq \mathbb{P}(\xi \leq x) \)。
  记\(\xi_n,\xi \)的分布函数分别为\(F_n,F \)。由\(F \)不连续点至多可数，可取\(\varepsilon_n \searrow 0\)，使\(F \)在\(x \pm \varepsilon_n \)处连续。
  于是\(\liminf_{n}\mathbb{P}(\xi_n<x) \geq \liminf_{n}\mathbb{P}(\xi_n<x-\varepsilon_m)=\mathbb{P}(\xi<x-\varepsilon_m),\limsup_{n}\mathbb{P}(\xi_n \leq x) \leq \limsup_{n}\mathbb{P}(\xi_n<x+\varepsilon_m) = \mathbb{P}(\xi \leq x+\varepsilon_m) \)。
  令\(m \to \infty \)即得。

  故有\(\forall x<y \)，有\(\liminf_{n} \mathbb{P}(\xi_n \in (x,y)) \geq \liminf_{n}\mathbb{P}(\xi_n<y)-\limsup_{n}\mathbb{P}(\xi_n \leq x) \geq \mathbb{P}(\xi<y)-\mathbb{P}(\xi \leq x)=\mathbb{P}(\xi \in (x,y)) \)。
  对于\(\mathbb{R} \)中的开集\(O \)，熟知\(A \)可表示为可数个开区间的并，于是\(\liminf_{n}\mathbb{P}(\xi_n \in O) \geq \mathbb{P}(\xi \in O) \)。
  注意到闭集的补集是开集，于是对于\(\mathbb{R} \)中的闭集\(C \)，有\(\limsup_{n}\mathbb{P}(\xi_n \in C) \leq \mathbb{P}(\xi \in C) \)。

  接下来证明
  \begin{equation}\label{equ:2}
    \mathbb{E} X = \int_{x \geq 0} \mathbb{P}(X>x) \d x=\int_{x \geq 0} \mathbb{P}(X \geq x) \d x
  \end{equation}
  对任何非负的随机变量\(X \)成立。
  由\(\mathbbm{1}_{x<X(\omega)} \geq 0,\forall x \in \mathbb{R},\omega \in \Omega \)，
  \begin{equation} \label{equ:1}
    \begin{aligned}
      \mathbb{E} X&=\int_{\Omega} X(\omega) \d \mathbb{P}\\
      &=\int_{\Omega} \int_{0}^{\infty} \mathbbm{1}_{x < X(\omega)} \d x \d \mathbb{P}\\
      &=\int_{0}^{\infty} \int_{\Omega} \mathbbm{1}_{x < X(\omega)} \d \mathbb{P} \d x\\
      &=\int_{0}^{\infty} \mathbb{P}(X>x) \d x
    \end{aligned}
  \end{equation}。
  在\eqref{equ:1}中将\(x<X \)换为\(x \leq X \)也成立。故\eqref{equ:2}成立。

  于是
  \begin{equation}
    \begin{aligned}
      \liminf_{n}\mathbb{E} g(\xi_n)&=\liminf_{n}\int_{0}^{\infty} \mathbb{P}(g(\xi_n)>x) \d x \\
      &=\liminf_{n} \int_{0}^{\infty} \mathbb{P}(\xi_n \in \{y:g(y)>x\}) \d x \\
      &\overset{Fatou}{=} \int_{0}^{\infty} \liminf_{n} \mathbb{P}(\xi_n \in \{y:g(y)>x\}) \d x\\
      &\overset{\{y:g(y)>x\}\text{是开集}}{\geq}\int_{0}^{\infty}\mathbb{P}(\xi \in \{y:g(y)>x\}) \d x\\
      &=\mathbb{E} g(\xi)
    \end{aligned}
  \end{equation}。
  同理可得\(\limsup_{n}\mathbb{E} g(\xi_n) \leq \mathbb{E} g(\xi) \)，于是\(\lim_{n} \mathbb{E} g(\xi_n)=\mathbb{E} g(\xi) \)。
\end{proof}

\begin{solution}
  令\(g_m(x)=\min(|x|,m) \)是有界连续函数，于是由引理 \ref{lem:1}知\(\lim_{n}\mathbb{E} g_m(\xi_n)=\mathbb{E} g_m(\xi) \)。
  对任何的\(m,n \)有\(g_m(\xi_n) \leq |\xi_n| \)，于是\(\mathbb{E} g_m(\xi) \leq \liminf_{n} \mathbb{E} |\xi_n| \)。
  注意到\(g_m(\xi)\nearrow |\xi| \)，由单调收敛定理知\(\mathbb{E} |\xi| =\lim_{m} \mathbb{E} g_m(\xi) \leq \liminf_{n} \mathbb{E} |\xi_n| \)。
\end{solution}

\begin{problem}\label{pro:3.6.13}
  设\(\xi \geq 0 \)使\(\mathbb{E} \xi^2 < \infty\)。证明\(\mathbb{P}(\xi >0) \geq \frac{(\mathbb{E} \xi)^2}{\mathbb{E} \xi^2} \)。
\end{problem}
\begin{solution}
  记\(\eta=\mathbbm{1}_{\xi>0} \)，则
  由 Cauchy 不等式知：
  \(\mathbb{E} \xi^2 \mathbb{P}(\xi>0)= \mathbb{E} \xi^2\eta^2 \mathbb{E}(\eta^2) \geq \mathbb{E}(\xi \eta^2)^2 = (\mathbb{E}\xi)^2\)。
  于是\(\mathbb{P}(\xi >0) \geq \frac{(\mathbb{E} \xi)^2}{\mathbb{E} \xi^2} \)。
\end{solution}

\begin{problem}\label{pro:3.6.15}
  利用 Jensen 不等式证明几何平均值小于代数平均值：
  \(a_1,\cdots,a_n \geq 0 \)及\(\alpha_1,\cdots,\alpha_n \geq 0 \)使\(\sum_{k=1}^{n}\alpha_k = 1 \)，有\(\prod_{k = 1}^{n}a_k^{\alpha_k} \leq \sum_{k = 1}^{n}\alpha_k a_k \)。
\end{problem}
\begin{solution}
  记\(\ln 0 =-\infty \)，则\(\ln x \)在\([0,\infty) \)上上凸。
  于是\(\sum_{k = 1}^{n}\alpha_k \ln a_k \leq \ln \sum_{k = 1}^{n} \alpha_k a_k \)，
  两边取\(\exp \)即得\(\prod_{k = 1}^{n}a_k^{\alpha_k} \leq \sum_{k = 1}^{n}\alpha_k a_k \)。
\end{solution}

\begin{problem}\label{pro:3.6.26}
  \begin{enumerate}
    \item 如\(\{f_t\}_{t \in T} \)一致可积，则必积分一致连续；
    \item 当\(\mu \)有限时，一致可积当且仅当积分一致有界且积分一致连续。
  \end{enumerate}
\end{problem}
\begin{solution}
  \begin{enumerate}
    \item \label{it:1}对于任何\(\varepsilon>0 \)，由\(f_t \)一致可积知\(\exists M>0 \)使\(\sup_{t \in T} \mu(|f_t| \mathbbm{1}_{|f_t|>M})<\frac{\varepsilon}{2} \)。
      取\(\delta=\frac{\varepsilon}{2M} \)，对于任何\(A \subset \Omega \)满足\(\mu(A)<\delta \)，有\(\mu(|f_t|\mathbbm{1}_A) \leq \mu(|f_t|\mathbbm{1}_A \mathbbm{1}_{|f_t| \leq M}) +\mu (|f_t|\mathbbm{1}_A \mathbbm{1}_{|f_t| > M})
        \leq \mu(M\mathbbm{1}_A) + \mu(|f_t|\mathbbm{1}_{|f_t|>M}) \leq M \cdot \delta + \frac{\varepsilon}{2}=\varepsilon
      \)。
      于是\(\{f_t\} \)积分一致连续。
    \item 由\ref{it:1}可知一致可积``\(\implies\)''积分一致连续。
      由一致可积，\(\exists M>0 \)使\(\sup_{t \in T} \mu(|f_t| \mathbbm{1}_{|f_t|>M})<1 \)。
      于是\(\sup_{t \in T} \mu(|f_t|) \leq \sup_{t \in T} \mu(|f_t|\mathbbm{1}_{|f_t| \leq M}) + \sup_{t \in T}\mu(|f_t|\mathbbm{1}_{|f_t|>M})
      \leq M \mu(\Omega) + 1\)。于是一致可积\(\implies\)积分一致有界。

      下面证明积分一致有界且积分一致连续\(\implies\)一致可积。
      由积分一致有界，\(\sup_{t \in T} \mu(|f_t|) \leq N \in \mathbb{R} \)。任取\(\varepsilon >0 \)，由积分一致连续知\(\exists \delta>0,\forall A \subset \Omega:\mu(A)\leq \delta,\forall t \in T,\mu(|f_t|\mathbbm{1}_{A}) \leq \frac{\varepsilon}{3} \)。
      由\(\mu(\{|f_t| \geq \frac{N}{\delta}\}) \leq \mu(\frac{|f_t|}{\frac{N}{\delta}})=\delta \)，得 \(\mu(|f_t|\mathbbm{1}_{|f_t| \geq \frac{N}{\delta}}) \leq \frac{\varepsilon}{3} \)对任何\(t \in T \)都成立。
      故\(\{f_t\} \)一致可积。
  \end{enumerate}
\end{solution}

\begin{problem}\label{pro:3.6.30}
  对可测函数\(f \)，定义本征上确界为：
  \(\norm{f}_{\infty} := \inf \{M: \mu(\{\omega:|f(\omega) |>M\}) = 0\} \)。
  \begin{enumerate}
    \item 证明\(\norm{\cdot}_{\infty} \)满足三角不等式。
    \item 若\(\mu(\Omega)<\infty \)，则\(\norm{f}_{\infty}=\lim_{r \to \infty} \norm{f}_{r} \)。
  \end{enumerate}
\end{problem}
\begin{solution}
  \begin{enumerate}
    \item 须证对任何\(f,g \)有\(\norm{f}_{\infty} + \norm{g}_{\infty} \geq \norm{f + g}_{\infty} \)。
      由定义，对任何\(\varepsilon>0 \)，\(\mu(\{\omega:|f(\omega)|>\norm{f}_{\infty} + \varepsilon\})=0 \)，取\(\varepsilon=\frac{1}{n} \)，由测度的下连续性知
      \(\mu\{\omega:|f(\omega)|>\norm{f}_{\infty}\}=0 \)。同理\(\mu\{\omega:|g(\omega)|>\norm{g}_{\infty}\}=0 \)。
      又\(|f+g| \leq |f| + |g| \)，故\(\mu(\{\omega:|f(\omega) + g(\omega)|>\norm{f}_{\infty} + \norm{g}_{\infty}\})=0 \)，
      由定义知\(\norm{f + g}_{\infty} \leq \norm{f}_{\infty} + \norm{g}_{\infty} \)。
    \item 对于\(M>\norm{f}_{\infty} \)，有：
      \begin{equation}\label{equ:1}
        \begin{aligned}
          \limsup_{r \to \infty} \frac{\norm{f}_{r}}{M}&= \limsup_{r \to \infty} \left(\int_{\Omega} \frac{|f|^r}{M^r} \d \mu\right)^{  \frac{1}{r} }\\
          & \leq  \limsup_{r \to \infty} \left(\int_{\Omega} \left(\frac{\norm{f}_{\infty}}{M}\right)^r \d \mu \right)^{\frac{1}{r}}\\
          &= \limsup_{r \to \infty} \frac{\norm{f}_{\infty}}{M} (\mu(\Omega))^{\frac{1}{r}} = \frac{\norm{f}_{\infty}}{M} <1
        \end{aligned}
      \end{equation}。
      于是\(\limsup_{r \to \infty} \norm{f}_{r} < M \)。故\(\limsup_{r \to \infty} \norm{f}_{r} \leq \norm{f}_{\infty} \)。

      对于\(0<M<\norm{f}_{\infty} \)，取\(M<N<\norm{f}_{\infty} \)，有：
      \begin{equation}\label{equ:2}
        \begin{aligned}
          \liminf_{r \to \infty} \frac{\norm{f}_{r}}{M}&= \liminf_{r \to \infty} \left(\int_{\Omega} \frac{|f|^r}{M^r} \d \mu\right)^{  \frac{1}{r} }\\
          & \geq  \liminf_{r \to \infty} \left(\int_{|f| \geq N} \left(\frac{N}{M}\right)^r \d \mu \right)^{\frac{1}{r}}\\
          &= \liminf_{r \to \infty} \frac{N}{M} (\mu(\{|f| \geq N\}))^{\frac{1}{r}} = \frac{N}{M} >1
        \end{aligned}
      \end{equation}。
      于是\(\liminf_{r \to \infty} \norm{f}_{r} > M \)。故\(\liminf_{r \to \infty} \norm{f}_{r} \geq \norm{f}_{\infty} \)。

      综上所述，\(\norm{f}_{\infty} = \lim_{r \to \infty} \norm{f}_{r} \)。
  \end{enumerate}
\end{solution}
\begin{problem}\label{pro:3.6.33}
  设随机变量\(\xi \)具有数学期望\(m \)与方差\(\sigma^2 \)。
  \begin{enumerate}
    \item 证明\(\mathbb{P}(\xi - m \geq t) \leq \frac{\sigma^2}{\sigma^2 + t^2}, \forall t \geq 0 \)。
    \item 证明\(\mathbb{P}(|\xi - m| \geq t) \leq \frac{2\sigma^2}{\sigma^2 + t^2} \)。
  \end{enumerate}
\end{problem}
\begin{solution}
  不妨设\(m=0 \)，否则用\(\xi-m \)代替\(\xi \)。
  方便起记\(p=\mathbb{P}(\xi \geq t) \)。
  \begin{enumerate}
    \item \label{it:2} 注意到 \(0=\mathbb{E}(\xi)\geq t \mathbb{P}(\xi \geq t) - \mathbb{E}(\xi^{-}) \)，故\(\mathbb{E} \xi^{-} \geq t p \)。
      于是由 Cauchy 不等式知\(\mathbb{E} (\xi^{-})^2 \mathbb{E} \mathbbm{1}_{\xi<0} \geq (\mathbb{E} \xi^{-})^2 \geq t^2 p^2 \)。
      结合\(\mathbb{E} \mathbbm{1}_{\xi<0} \leq 1-\mathbb{P}(\xi \geq t) \)知 \(\mathbb{E} (\xi^{-})^2 \geq t^2 \frac{p^2}{1- p} \)。
      又\(\mathbb{E} (\xi^{+})^2 \geq \mathbb{E} \xi^2 \mathbbm{1}_{\xi \geq t} \geq t^2 p \)，于是
      \(\sigma^2 = \mathbb{E} (\xi^{+})^2 + \mathbb{E} (\xi^{-})^2 \geq t^2  \frac{p}{1-p} \)。
      于是\(\frac{\sigma^2}{t^2}(1-p) \geq p\)，整理得
      \(p \leq \frac{\sigma^2}{\sigma^2 + t^2} \)。
    \item 对\(-\xi \) 有\(\mathbb{P}(-\xi \geq t) \leq \frac{\sigma^2}{\sigma^2 + t^2} \)，
      与\(\mathbb{P}(\xi \geq t ) \leq \frac{\sigma^2}{\sigma^2 + t^2} \)相加可得\(\mathbb{P}(|\xi| \geq t) \leq \frac{2 \sigma^2}{\sigma^2 t^2} \)。
  \end{enumerate}
\end{solution}
\end{document}
